#include "music.h"
#include "delay.h"
#include "sound.h"
#include "display.h"

uchar code NUM0[]={0x00,0x00,0x18,0x7E,0x7E,0xE7,0xE7,0xE7,0xE7,0xE7,0xE7,0xE7,0x7E,0x3C,0x00,0x00};
	uchar code NUM1[]={0x00,0x00,0x00,0x1C,0x3C,0x7C,0x7C,0x1C,0x1C,0x1C,0x1C,0x1C,0x1C,0x1C,0x00,0x00};
	uchar code NUM2[]={0x00,0x00,0x18,0x7E,0xFE,0xE7,0x07,0x0E,0x0E,0x1C,0x38,0x70,0xFF,0xFF,0x00,0x00};
	uchar code NUM3[]={0x00,0x00,0x18,0x7E,0xFF,0xE7,0x06,0x1E,0x1E,0x07,0x47,0xE7,0x7E,0x7C,0x00,0x00};
	uchar code NUM4[]={0x00,0x00,0x04,0x0E,0x1E,0x1E,0x3E,0x7E,0x6E,0xEE,0xFF,0xFF,0x0E,0x0E,0x00,0x00};
	uchar code NUM5[]={0x00,0x00,0x00,0x7E,0x7E,0xE0,0xFC,0xFE,0xC7,0x07,0x47,0xC7,0xFE,0x7C,0x00,0x00};
	uchar code NUM6[]={0x00,0x00,0x0C,0x1C,0x1C,0x38,0x78,0x7E,0xE7,0xE7,0xE7,0xE7,0xFF,0x7E,0x00,0x00};
	uchar code NUM7[]={0x00,0x00,0x00,0xFF,0x7F,0x06,0x0E,0x0C,0x1C,0x18,0x38,0x38,0x38,0x70,0x00,0x00};
	uchar code NUM8[]={0x00,0x00,0x10,0x7E,0xEE,0xE7,0xE6,0x7E,0xFE,0xE7,0xC7,0xE7,0xFE,0x7E,0x00,0x00};
	uchar code NUM9[]={0x00,0x00,0x18,0x7E,0xEE,0xE7,0xC7,0xE7,0xFE,0x7E,0x1C,0x18,0x38,0x70,0x00,0x00};
//数字0到9的字模

	uchar code note0[]={0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00};
	uchar code note1[]={0x00,0x00,0x00,0x1C,0x3C,0x7C,0x7C,0x1C,0x1C,0x1C,0x1C,0x1C,0x1C,0x1C,0x00,0x18};
	uchar code note2[]={0x00,0x00,0x18,0x7E,0xFE,0xE7,0x07,0x0E,0x0E,0x1C,0x38,0x70,0xFF,0xFF,0x00,0x18};
	uchar code note3[]={0x00,0x00,0x18,0x7E,0xFF,0xE7,0x06,0x1E,0x1E,0x07,0x47,0xE7,0x7E,0x7C,0x00,0x18};
	uchar code note4[]={0x00,0x00,0x04,0x0E,0x1E,0x1E,0x3E,0x7E,0x6E,0xEE,0xFF,0xFF,0x0E,0x0E,0x00,0x18};
	uchar code note5[]={0x00,0x00,0x00,0x7E,0x7E,0xE0,0xFC,0xFE,0xC7,0x07,0x47,0xC7,0xFE,0x7C,0x00,0x18};
	uchar code note6[]={0x00,0x00,0x0C,0x1C,0x1C,0x38,0x78,0x7E,0xE7,0xE7,0xE7,0xE7,0xFF,0x7E,0x00,0x18};
	uchar code note7[]={0x00,0x00,0x00,0xFF,0x7F,0x06,0x0E,0x0C,0x1C,0x18,0x38,0x38,0x38,0x70,0x00,0x18};
	uchar code note8[]={0x00,0x00,0x00,0x1C,0x3C,0x7C,0x7C,0x1C,0x1C,0x1C,0x1C,0x1C,0x1C,0x1C,0x00,0x00};
	uchar code note9[]={0x00,0x00,0x18,0x7E,0xFE,0xE7,0x07,0x0E,0x0E,0x1C,0x38,0x70,0xFF,0xFF,0x00,0x00};
	uchar code note10[]={0x00,0x00,0x18,0x7E,0xFF,0xE7,0x06,0x1E,0x1E,0x07,0x47,0xE7,0x7E,0x7C,0x00,0x00};
	uchar code note11[]={0x00,0x00,0x04,0x0E,0x1E,0x1E,0x3E,0x7E,0x6E,0xEE,0xFF,0xFF,0x0E,0x0E,0x00,0x00};
	uchar code note12[]={0x00,0x00,0x00,0x7E,0x7E,0xE0,0xFC,0xFE,0xC7,0x07,0x47,0xC7,0xFE,0x7C,0x00,0x00};
	uchar code note13[]={0x00,0x00,0x0C,0x1C,0x1C,0x38,0x78,0x7E,0xE7,0xE7,0xE7,0xE7,0xFF,0x7E,0x00,0x00};
	uchar code note14[]={0x00,0x00,0x00,0xFF,0x7F,0x06,0x0E,0x0C,0x1C,0x18,0x38,0x38,0x38,0x70,0x00,0x00};
	uchar code note15[]={0x18,0x00,0x00,0x1C,0x3C,0x7C,0x7C,0x1C,0x1C,0x1C,0x1C,0x1C,0x1C,0x1C,0x00,0x00};
	uchar code note16[]={0x18,0x00,0x18,0x7E,0xFE,0xE7,0x07,0x0E,0x0E,0x1C,0x38,0x70,0xFF,0xFF,0x00,0x00};
	uchar code note17[]={0x18,0x00,0x18,0x7E,0xFF,0xE7,0x06,0x1E,0x1E,0x07,0x47,0xE7,0x7E,0x7C,0x00,0x00};
	uchar code note18[]={0x18,0x00,0x04,0x0E,0x1E,0x1E,0x3E,0x7E,0x6E,0xEE,0xFF,0xFF,0x0E,0x0E,0x00,0x00};
	uchar code note19[]={0x18,0x00,0x00,0x7E,0x7E,0xE0,0xFC,0xFE,0xC7,0x07,0x47,0xC7,0xFE,0x7C,0x00,0x00};
	uchar code note20[]={0x18,0x00,0x0C,0x1C,0x1C,0x38,0x78,0x7E,0xE7,0xE7,0xE7,0xE7,0xFF,0x7E,0x00,0x00};
	uchar code note21[]={0x18,0x00,0x0C,0x1C,0x1C,0x38,0x78,0x7E,0xE7,0xE7,0xE7,0xE7,0xFF,0x7E,0x00,0x00};
//三个音阶，一共21个音符的字模

	uchar code BNOTE0[]={0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
						0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
						0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00};
	uchar code BNOTE1[]={0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x0E,0x00,0x3E,0x00,0x0E,0x00,0x0E,0x00,
						0x0E,0x00,0x0E,0x00,0x0E,0x00,0x0E,0x00,0x0E,0x00,0x0E,0x00,0x0E,0x00,0x0E,0x00,
						0x0E,0x00,0x3F,0x80,0x00,0x00,0x0c,0x00,0x00,0x00};
	uchar code BNOTE2[]={0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x3F,0x80,0x7B,0xC0,0x61,0xC0,0x71,0xC0,
						0x71,0xC0,0x01,0xC0,0x03,0x80,0x07,0x00,0x0E,0x00,0x1C,0x00,0x38,0x00,0x70,0xC0,
						0x61,0xC0,0xFF,0xC0,0x00,0x00,0x0c,0x00,0x00,0x00};
	uchar code BNOTE3[]={0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x3F,0x00,0x73,0x80,0x71,0xC0,0x71,0xC0,
						0x01,0x80,0x07,0x80,0x0F,0x00,0x03,0x80,0x01,0xC0,0x01,0xC0,0x71,0xC0,0x71,0xC0,
						0x73,0x80,0x3F,0x80,0x00,0x00,0x0c,0x00,0x00,0x00};
	uchar code BNOTE4[]={0x00,0x00,0x00,0x00,0x00,0x00,0x03,0x00,0x07,0x00,0x07,0x00,0x0F,0x00,0x1F,0x00,
						0x1F,0x00,0x37,0x00,0x37,0x00,0x67,0x00,0xC7,0x00,0xFF,0xC0,0x07,0x00,0x07,0x00,
						0x07,0x00,0x1F,0xC0,0x00,0x00,0x0c,0x00,0x00,0x00};
	uchar code BNOTE5[]={0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x7F,0xC0,0x7F,0x80,0x60,0x00,0x60,0x00,
						0x60,0x00,0x7F,0x80,0x7B,0xC0,0x61,0xC0,0x01,0xC0,0x00,0xC0,0x71,0xC0,0x71,0xC0,
						0x7F,0x80,0x3F,0x00,0x00,0x00,0x0c,0x00,0x00,0x00};
	uchar code BNOTE6[]={0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x1F,0x80,0x3D,0xC0,0x71,0xC0,0x70,0x00,
						0x70,0x00,0xFF,0x80,0xFB,0xC0,0xF1,0xC0,0xE0,0xE0,0xE0,0xE0,0x70,0xE0,0x71,0xC0,
						0x3B,0xC0,0x1F,0x80,0x00,0x00,0x0c,0x00,0x00,0x00};
	uchar code BNOTE7[]={0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x7F,0xC0,0x7F,0x80,0x61,0x80,0x03,0x00,
						0x03,0x00,0x06,0x00,0x06,0x00,0x0E,0x00,0x0C,0x00,0x1C,0x00,0x1C,0x00,0x1C,0x00,
						0x1C,0x00,0x1C,0x00,0x00,0x00,0x0c,0x00,0x00,0x00};
	uchar code BNOTE8[]={0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x0E,0x00,0x3E,0x00,0x0E,0x00,0x0E,0x00,
						0x0E,0x00,0x0E,0x00,0x0E,0x00,0x0E,0x00,0x0E,0x00,0x0E,0x00,0x0E,0x00,0x0E,0x00,
						0x0E,0x00,0x3F,0x80,0x00,0x00,0x00,0x00,0x00,0x00};
	uchar code BNOTE9[]={0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x3F,0x80,0x7B,0xC0,0x61,0xC0,0x71,0xC0,
						0x71,0xC0,0x01,0xC0,0x03,0x80,0x07,0x00,0x0E,0x00,0x1C,0x00,0x38,0x00,0x70,0xC0,
						0x61,0xC0,0xFF,0xC0,0x00,0x00,0x00,0x00,0x00,0x00};
	uchar code BNOTE10[]={0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x3F,0x00,0x73,0x80,0x71,0xC0,0x71,0xC0,
						0x01,0x80,0x07,0x80,0x0F,0x00,0x03,0x80,0x01,0xC0,0x01,0xC0,0x71,0xC0,0x71,0xC0,
						0x73,0x80,0x3F,0x80,0x00,0x00,0x00,0x00,0x00,0x00};
	uchar code BNOTE11[]={0x00,0x00,0x00,0x00,0x00,0x00,0x03,0x00,0x07,0x00,0x07,0x00,0x0F,0x00,0x1F,0x00,
						0x1F,0x00,0x37,0x00,0x37,0x00,0x67,0x00,0xC7,0x00,0xFF,0xC0,0x07,0x00,0x07,0x00,
						0x07,0x00,0x1F,0xC0,0x00,0x00,0x00,0x00,0x00,0x00};
	uchar code BNOTE12[]={0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x7F,0xC0,0x7F,0x80,0x60,0x00,0x60,0x00,
						0x60,0x00,0x7F,0x80,0x7B,0xC0,0x61,0xC0,0x01,0xC0,0x00,0xC0,0x71,0xC0,0x71,0xC0,
						0x7F,0x80,0x3F,0x00,0x00,0x00,0x00,0x00,0x00,0x00};
	uchar code BNOTE13[]={0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x1F,0x80,0x3D,0xC0,0x71,0xC0,0x70,0x00,
						0x70,0x00,0xFF,0x80,0xFB,0xC0,0xF1,0xC0,0xE0,0xE0,0xE0,0xE0,0x70,0xE0,0x71,0xC0,
						0x3B,0xC0,0x1F,0x80,0x00,0x00,0x00,0x00,0x00,0x00};
	uchar code BNOTE14[]={0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x7F,0xC0,0x7F,0x80,0x61,0x80,0x03,0x00,
						0x03,0x00,0x06,0x00,0x06,0x00,0x0E,0x00,0x0C,0x00,0x1C,0x00,0x1C,0x00,0x1C,0x00,
						0x1C,0x00,0x1C,0x00,0x00,0x00,0x00,0x00,0x00,0x00};
	uchar code BNOTE15[]={0x00,0x00,0x0c,0x00,0x00,0x00,0x00,0x00,0x0E,0x00,0x3E,0x00,0x0E,0x00,0x0E,0x00,
						0x0E,0x00,0x0E,0x00,0x0E,0x00,0x0E,0x00,0x0E,0x00,0x0E,0x00,0x0E,0x00,0x0E,0x00,
						0x0E,0x00,0x3F,0x80,0x00,0x00,0x00,0x00,0x00,0x00};
	uchar code BNOTE16[]={0x00,0x00,0x0c,0x00,0x00,0x00,0x00,0x00,0x3F,0x80,0x7B,0xC0,0x61,0xC0,0x71,0xC0,
						0x71,0xC0,0x01,0xC0,0x03,0x80,0x07,0x00,0x0E,0x00,0x1C,0x00,0x38,0x00,0x70,0xC0,
						0x61,0xC0,0xFF,0xC0,0x00,0x00,0x00,0x00,0x00,0x00};
	uchar code BNOTE17[]={0x00,0x00,0x0c,0x00,0x00,0x00,0x00,0x00,0x3F,0x00,0x73,0x80,0x71,0xC0,0x71,0xC0,
						0x01,0x80,0x07,0x80,0x0F,0x00,0x03,0x80,0x01,0xC0,0x01,0xC0,0x71,0xC0,0x71,0xC0,
						0x73,0x80,0x3F,0x80,0x00,0x00,0x00,0x00,0x00,0x00};
	uchar code BNOTE18[]={0x00,0x00,0x0c,0x00,0x00,0x00,0x03,0x00,0x07,0x00,0x07,0x00,0x0F,0x00,0x1F,0x00,
						0x1F,0x00,0x37,0x00,0x37,0x00,0x67,0x00,0xC7,0x00,0xFF,0xC0,0x07,0x00,0x07,0x00,
						0x07,0x00,0x1F,0xC0,0x00,0x00,0x00,0x00,0x00,0x00};
	uchar code BNOTE19[]={0x00,0x00,0x0c,0x00,0x00,0x00,0x00,0x00,0x7F,0xC0,0x7F,0x80,0x60,0x00,0x60,0x00,
						0x60,0x00,0x7F,0x80,0x7B,0xC0,0x61,0xC0,0x01,0xC0,0x00,0xC0,0x71,0xC0,0x71,0xC0,
						0x7F,0x80,0x3F,0x00,0x00,0x00,0x00,0x00,0x00,0x00};
	uchar code BNOTE20[]={0x00,0x00,0x0c,0x00,0x00,0x00,0x00,0x00,0x1F,0x80,0x3D,0xC0,0x71,0xC0,0x70,0x00,
						0x70,0x00,0xFF,0x80,0xFB,0xC0,0xF1,0xC0,0xE0,0xE0,0xE0,0xE0,0x70,0xE0,0x71,0xC0,
						0x3B,0xC0,0x1F,0x80,0x00,0x00,0x00,0x00,0x00,0x00};
	uchar code BNOTE21[]={0x00,0x00,0x0c,0x00,0x00,0x00,0x00,0x00,0x7F,0xC0,0x7F,0x80,0x61,0x80,0x03,0x00,
						0x03,0x00,0x06,0x00,0x06,0x00,0x0E,0x00,0x0C,0x00,0x1C,0x00,0x1C,0x00,0x1C,0x00,
						0x1C,0x00,0x1C,0x00,0x00,0x00,0x00,0x00,0x00,0x00};
//三个音阶，一共21个音符的大号字模

	uchar code key0[]={0x00,0x00,0x3F,0xC0,0x3F,0xC0,0x30,0xC0,0x30,0xC0,0x30,0xC0,0x30,0xC0,0x30,0xC0,
					   0x30,0xC0,0x36,0xC0,0x36,0xC0,0x36,0xC0,0x36,0xC0,0x36,0xC0,0x36,0xC0,0x36,0xC0};
	uchar code key1[]={0x00,0x00,0x3F,0xC0,0x3F,0xC0,0x3F,0xC0,0x3F,0xC0,0x3F,0xC0,0x3F,0xC0,0x3F,0xC0,
					   0x3F,0xC0,0x3F,0xC0,0x3F,0xC0,0x3F,0xC0,0x3F,0xC0,0x3F,0xC0,0x3F,0xC0,0x3F,0xC0};
	
	uchar code streak1[]={0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x07,0x00,0x00,0x00,0x00,0x00,0x1F,0x00,0x00,
							0x00,0x00,0x71,0x9F,0x00,0x00,0x00,0x00,0x73,0x9F,0x00,0x00,0x00,0x00,0x3F,0x87,
							0x00,0x00,0x00,0x00,0x1F,0x07,0x00,0x00,0x00,0x00,0x1E,0x07,0x00,0x00,0x00,0x00,
							0x3F,0x07,0x00,0x00,0x00,0x00,0x7B,0x87,0x00,0x00,0x00,0x00,0x71,0x87,0x00,0x00,
							0x00,0x00,0x00,0x9F,0xC0,0x00,0x00,0x00,0x00,0x1F,0xC0,0x00,0x00,0x00,0x00,0x00,
							0x00,0x00,0x00,0x00};
	uchar code streak2[]={0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x0F,0x00,0x00,0x00,0x00,0x00,0x1F,0x80,0x00,
							0x00,0x00,0x00,0x3B,0xC0,0x00,0x00,0x00,0x73,0xB1,0xC0,0x00,0x00,0x00,0x7B,0x81,
							0xC0,0x00,0x00,0x00,0x3F,0x03,0x80,0x00,0x00,0x00,0x1E,0x07,0x80,0x00,0x00,0x00,
							0x1F,0x0F,0x00,0x00,0x00,0x00,0x7F,0x9E,0x00,0x00,0x00,0x00,0x73,0x9C,0x00,0x00,
							0x00,0x00,0x71,0xBF,0xC0,0x00,0x00,0x00,0x00,0x3F,0xC0,0x00,0x00,0x00,0x00,0x00,
							0x00,0x00,0x00,0x00};
	uchar code streak3[]={0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x07,0xC0,0x00,0x00,0x00,0x00,0x0F,0xE0,0x00,
							0x00,0x00,0x38,0xCC,0x60,0x00,0x00,0x00,0x3D,0xCC,0x60,0x00,0x00,0x00,0x1F,0xC0,
							0xE0,0x00,0x00,0x00,0x0F,0x83,0xC0,0x00,0x00,0x00,0x07,0x03,0xC0,0x00,0x00,0x00,
							0x1F,0x80,0xE0,0x00,0x00,0x00,0x3D,0xDC,0x70,0x00,0x00,0x00,0x38,0xDC,0x70,0x00,
							0x00,0x00,0x38,0x4E,0x70,0x00,0x00,0x00,0x00,0x07,0xE0,0x00,0x00,0x00,0x00,0x00,
							0x00,0x00,0x00,0x00};
	uchar code streak4[]={0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x80,0x00,0x00,0x00,0x00,0x01,0x80,0x00,
							0x00,0x00,0x61,0x83,0x80,0x00,0x00,0x00,0x73,0x87,0x80,0x00,0x00,0x00,0x7F,0x8F,
							0x80,0x00,0x00,0x00,0x3F,0x0D,0x80,0x00,0x00,0x00,0x1E,0x1D,0x80,0x00,0x00,0x00,
							0x3F,0x39,0x80,0x00,0x00,0x00,0x7F,0xBF,0xC0,0x00,0x00,0x00,0x73,0xBF,0xC0,0x00,
							0x00,0x00,0x61,0x81,0x80,0x00,0x00,0x00,0x00,0x01,0x80,0x00,0x00,0x00,0x00,0x00,
							0x00,0x00,0x00,0x00};
//	uchar code good[]={0x00,0x00,0x00,0x00,0x01,0x80,0x0E,0x00,0x00,0x03,0x01,0x80,0x3F,0x80,0x00,0x03,
//							0x01,0x80,0x7F,0xC0,0x00,0x03,0x01,0x80,0x71,0xCE,0x0E,0x1F,0x01,0x80,0x60,0x5F,
//							0x9F,0x3F,0x01,0x80,0xE0,0x31,0xB1,0xB3,0x01,0x80,0xE7,0xB1,0xB1,0xB3,0x01,0x80,
//							0xE7,0xF1,0xB1,0xB3,0x01,0x80,0x60,0xF1,0xB1,0xB3,0x01,0x80,0x71,0xF1,0xB1,0xB3,
//							0x00,0x00,0x7F,0xDF,0xBF,0xBF,0x01,0x80,0x3F,0x9F,0x1F,0x3E,0x01,0x80,0x00,0x00,
//							0x00,0x00,0x00,0x00};
	uchar code good[]={0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x3F,0x80,0x00,0x03,
							0x01,0x80,0x7F,0xC0,0x00,0x03,0x01,0x80,0x71,0xCE,0x0E,0x1F,0x01,0x80,0x60,0x5F,
							0xBF,0x3F,0x01,0x80,0xE0,0x31,0xBD,0xB3,0x01,0x80,0xE7,0xB1,0xB1,0xB3,0x01,0x80,
							0xE7,0xF1,0xB1,0xB3,0x01,0x80,0x60,0xF1,0xA1,0xB3,0x01,0x80,0x71,0xF1,0xB1,0xB3,
							0x00,0x00,0x7F,0xDF,0xBF,0xBF,0x01,0x80,0x3F,0x9F,0x1F,0x3F,0x01,0x80,0x00,0x00,
							0x00,0x00,0x00,0x00};
	uchar code miss[]={0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x30,0x00,0x00,0x07,0x00,0x00,
							0x30,0x00,0x70,0x37,0x00,0x00,0x30,0x00,0x78,0x70,0x00,0x00,0x30,0x00,0x78,0x77,
							0x79,0xE0,0x30,0x00,0x7C,0xF7,0x7D,0xF0,0x30,0x00,0x7E,0xF7,0x6D,0xB0,0x30,0x00,
							0x7F,0xF7,0x79,0xC0,0x30,0x00,0x77,0xF7,0x7D,0xF0,0x30,0x00,0x73,0xB7,0x1C,0x70,
							0x00,0x00,0x73,0xB7,0x4F,0x30,0x30,0x00,0x70,0x37,0x7D,0xE0,0x30,0x00,0x00,0x00,
							0x00,0x00,0x00,0x00};
//连击与miss的字模

	uchar code  gay[]={0x07,0xFC,0x0F,0xFE,0x0F,0xFE,0x0C,0x06,0x0F,0xFE,0x0F,0xFE,0x0C,0x06,0x0C,0x06,
						0x0C,0x06,0x0C,0x06,0x3C,0x1E,0x7C,0x3E,0x7C,0x7E,0x7C,0x7C,0x38,0x38,0x00,0x00};
	uchar code add2[]={0x00,0x00,0x00,0x18,0x00,0x3C,0x18,0x66,0x18,0x62,0x18,0x06,0x7F,0x0C,0x18,0x18,
						0x18,0x30,0x18,0x60,0x00,0x7E,0x00,0x00};


sbit k1 = P1^1;
sbit k2 = P1^2;
sbit k3 = P1^3;
sbit k4 = P1^4;
sbit k5 = P1^5;
sbit k6 = P1^6;
sbit k7 = P1^7;
sbit k0 = P1^0;
sbit high = P4^5;
sbit low  = P4^4;

extern uchar n = 0;
//uchar code Music_Tab1[] = {10,2,10,2,11,2,12,2,12,2,13,2,10,2,9,2,
//						   8,2,8,2,9,2,10,2,10,3,9,1,9,4,
//						   10,2,10,2,11,2,12,2,12,2,11,2,10,2,10,2,
//						   8,2,8,2,9,2,10,2,8,3,8,1,8,4,
//						   9,2,9,2,10,2,8,2,9,2,10,1,11,1,10,2,8,2,
//						   9,2,10,1,11,1,11,2,9,2,8,2,9,2,5,4,
//						   10,2,10,2,11,2,12,2,12,2,11,2,10,2,9,2,
//						   8,2,8,2,9,2,10,2,9,3,8,1,8,4,0};

uchar code Music_Tab1[] = {10,2,10,2,11,2,12,2,12,2,11,2,10,2,9,2,
						   8,2,8,2,9,2,10,2,10,3,9,1,9,4,
						   10,2,10,2,11,2,12,2,12,2,11,2,10,2,9,2,
						   8,2,8,2,9,2,10,2,9,3,8,1,8,4,
						   9,2,9,2,10,2,8,2,9,2,10,1,11,1,10,2,8,2,
						   9,2,10,1,11,1,10,2,9,2,8,2,9,2,5,4,
						   10,2,10,2,11,2,12,2,12,2,11,2,10,2,9,2,
						   8,2,8,2,9,2,10,2,9,3,8,1,8,4,0,0,0,0,0,0,0,0};	  //欢乐颂

uchar code Music_Tab2[] = {13,1,14,1,
						   15,3,14,1,15,2,17,2,14,5,10,2,
						   13,3,12,1,13,2,15,2,12,5,10,2,
						   11,3,10,1,11,1,15,1,15,2,10,5,15,2,
						   14,3,11,1,11,2,14,2,14,4,0,0,0,0,0,0,0,0}	 ;	 //天空之城


void drawPiano(void)
{
     //在屏幕下方显示出钢琴按键
	 show_Pic(0,47,2,16,key0);
	 show_Pic(16,47,2,16,key0);
	 show_Pic(32,47,2,16,key0);
	 show_Pic(16*3,47,2,16,key0);
	 show_Pic(16*4,47,2,16,key0);
	 show_Pic(16*5,47,2,16,key0);
	 show_Pic(16*6,47,2,16,key0);
	 show_Pic(16*3,0,2,16,gay);
}

void showStatus(unsigned char status)
{
    //如果status》=5，显示good；如果status=0，显示miss;中间显示*x
	if(status>=5)
	   { show_Pic(5*16,14,6,14,good);//great
		 show_Pic(7*16,28,2,12,add2);
	   }
	else if(status==0)
	    {show_Pic(5*16,14,6,14,miss);//miss
		 show_Pic(7*16,28,2,14,BNOTE0);
		}
	else{
	    switch(status)
		{
	    case(1):show_Pic(5*16,14,6,14,streak1); break;
		case(2):show_Pic(5*16,14,6,14,streak2); break;
		case(3):show_Pic(5*16,14,6,14,streak3); break;
		case(4):show_Pic(5*16,14,6,14,streak4); break;//streak*
		}
	}		  
}

void discore(unsigned char value, unsigned char roll)	//分数显示函数，被showscore调用
{
     switch(value)
    {
        case 0:show_Pic(16*(7-roll),0,1,16,NUM0);break;
        case 1:show_Pic(16*(7-roll),0,1,16,NUM1);break;
        case 2:show_Pic(16*(7-roll),0,1,16,NUM2);break;
        case 3:show_Pic(16*(7-roll),0,1,16,NUM3);break;
        case 4:show_Pic(16*(7-roll),0,1,16,NUM4);break;
        case 5:show_Pic(16*(7-roll),0,1,16,NUM5);break;
        case 6:show_Pic(16*(7-roll),0,1,16,NUM6);break;
        case 7:show_Pic(16*(7-roll),0,1,16,NUM7);break;
        case 8:show_Pic(16*(7-roll),0,1,16,NUM8);break;
        case 9:show_Pic(16*(7-roll),0,1,16,NUM9);break;
    } 
}

void showScore(unsigned char score)		 //分数显示函数
{
    //在屏幕右上角显示出传入的分数
	unsigned char hun,ten,dig,hune;
	hun=score/100;
	hune=score%100;
	ten=hune/10;
	dig=hune%10;
	discore(hun,2);
	discore(ten,1);
	discore(dig,0);
}

void showNote(unsigned char note, unsigned char row)		 //左上角音符显示函数
{
	 row = row-1;
	 switch(note)
    {
	    case 0:show_Pic(16*row,0,1,16,note0);break;
        case 1:show_Pic(16*row,0,1,16,note1);break;
        case 2:show_Pic(16*row,0,1,16,note2);break;
        case 3:show_Pic(16*row,0,1,16,note3);break;
        case 4:show_Pic(16*row,0,1,16,note4);break;
		case 5:show_Pic(16*row,0,1,16,note5);break;
        case 6:show_Pic(16*row,0,1,16,note6);break;
		case 7:show_Pic(16*row,0,1,16,note7);break;
        case 8:show_Pic(16*row,0,1,16,note8);break;
		case 9:show_Pic(16*row,0,1,16,note9);break;
        case 10:show_Pic(16*row,0,1,16,note10);break;
        case 11:show_Pic(16*row,0,1,16,note11);break;
        case 12:show_Pic(16*row,0,1,16,note12);break;
		case 13:show_Pic(16*row,0,1,16,note13);break;
        case 14:show_Pic(16*row,0,1,16,note14);break;
		case 15:show_Pic(16*row,0,1,16,note15);break;
        case 16:show_Pic(16*row,0,1,16,note16);break;
		case 17:show_Pic(16*row,0,1,16,note17);break;
        case 18:show_Pic(16*row,0,1,16,note18);break;
		case 19:show_Pic(16*row,0,1,16,note19);break;
        case 20:show_Pic(16*row,0,1,16,note20);break;
		case 21:show_Pic(16*row,0,1,16,note21);break;
    } 
}

void rushNote(unsigned char note)					//屏幕中间音符显示函数
{
	 unsigned char row;
	 row=note%7;
	 if(row==0)
	     row=7;
	row = row-1;
	  switch(note)
    {
	    case 0:show_Pic(16*row,27,2,21,BNOTE0);break;
        case 1:show_Pic(16*row,27,2,21,BNOTE1);break;
        case 2:show_Pic(16*row,27,2,21,BNOTE2);break;
        case 3:show_Pic(16*row,27,2,21,BNOTE3);break;
        case 4:show_Pic(16*row,27,2,21,BNOTE4);break;
		case 5:show_Pic(16*row,27,2,21,BNOTE5);break;
        case 6:show_Pic(16*row,27,2,21,BNOTE6);break;
		case 7:show_Pic(16*row,27,2,21,BNOTE7);break;
        case 8:show_Pic(16*row,27,2,21,BNOTE8);break;
		case 9:show_Pic(16*row,27,2,21,BNOTE9);break;
        case 10:show_Pic(16*row,27,2,21,BNOTE10);break;
        case 11:show_Pic(16*row,27,2,21,BNOTE11);break;
        case 12:show_Pic(16*row,27,2,21,BNOTE12);break;
		case 13:show_Pic(16*row,27,2,21,BNOTE13);break;
        case 14:show_Pic(16*row,27,2,21,BNOTE14);break;
		case 15:show_Pic(16*row,27,2,21,BNOTE15);break;
        case 16:show_Pic(16*row,27,2,21,BNOTE16);break;
		case 17:show_Pic(16*row,27,2,21,BNOTE17);break;
        case 18:show_Pic(16*row,27,2,21,BNOTE18);break;
		case 19:show_Pic(16*row,27,2,21,BNOTE19);break;
        case 20:show_Pic(16*row,27,2,21,BNOTE20);break;
		case 21:show_Pic(16*row,27,2,21,BNOTE21);break;
    } 

}

void musicGameEnd(unsigned char score)			//结束函数
{
    
	unsigned char hun1;
	unsigned char ten1;
	unsigned char dig1;
	unsigned char hune1;
	init();
	hun1=48+score/100;
	hune1=score%100;
	ten1=48+hune1/10;
	dig1=48+hune1%10;
	discore(hun1,2);
	discore(ten1,1);
	discore(dig1,0);
	Lcd_WriteCmd(0x01);  
    Lcd_WriteStr(0,0,"游戏结束");
	Lcd_WriteStr(1,0,"您的得分是");
	Lcd_WriteData(58);
	Lcd_WriteData(hun1);
	Lcd_WriteData(ten1);
	Lcd_WriteData(dig1);
	Lcd_WriteStr(2,0,"按左上角退出");
}

unsigned char checkKey(unsigned char note,unsigned char flag)		   //按键识别函数
{
    unsigned char sign,value;
	value=0;
	sign=0;
//	if(flag==1)
//	    return 1;
//	else
//	{
	    if(k1==0||k2==0||k3==0||k4==0||k5==0||k6==0||k7==0||k0==0)
		{
		if(k1==0) sign=(8+7*high-7*low);
	    if(k2==0) sign=(9+7*high-7*low);
	    if(k3==0) sign=(10+7*high-7*low);
	    if(k4==0) sign=(11+7*high-7*low);
	    if(k5==0) sign=(12+7*high-7*low);
	    if(k6==0) sign=(13+7*high-7*low);
	    if(k7==0) sign=(14+7*high-7*low);
		 }

   
//		if(sign==note)
//		    value=1; 

		return sign;
//	}
//	return 0;
}

void musicGame(unsigned char speed)
{
    
	uchar p,m,flag,score,streak,time,sign;   //m为频率常数变量,flag为是否得分,score为得分量,streak为连击次数    
	uchar i=0;
	speed=speed*15;    	  	   //速度处理
	TMOD|=0x11;    
	ET0=1; 		 //为了不影响别的使能位
	drawPiano();		 //画键盘
	score=0;
	streak=0;
	flag=0;
	time=1;
	showScore(score);		//显示分数
	showStatus(streak);		//显示连击状态
	while(menuflag==9)
	{
	    if((p%7)==0)
		    show_Pic(16*6,27,2,21,BNOTE0);
		else
		    show_Pic(16*(p%7)-16,27,2,21,BNOTE0);
	    flag=0;	   //每次初始化标志位
		showStatus(streak);	  //显示连击数
		
		if(Music_Tab1[i+6]!=0)		   //左上角显示接下来要出现的音符
		{
		showNote(Music_Tab1[i+2],3);
		showNote(Music_Tab1[i+4],2);
		showNote(Music_Tab1[i+6],1);
		}else if(Music_Tab1[i+4]!=0)
		{
		showNote(Music_Tab1[i+2],3);
		showNote(Music_Tab1[i+4],2);
        showNote(0,1);	//0代表空白
		}else if(Music_Tab1[i+2]!=0)
		{
		showNote(Music_Tab1[i+2],3);
		showNote(0,2);
        showNote(0,1);
		}else
		{
		showNote(0,3);
		showNote(0,2);
        showNote(0,1);
		}

		TH0=0xd8;TL0=0xef;
		p = Music_Tab1[i];
		if(p==0)break;
		else
		{
			m = p; 
			i++;
			n = Music_Tab1[i]*speed;		 //改变这个可以调整每个音的时间长短
			TR0 = 1;
			rushNote(p);
			while(n!=0)
			{
				
				if(time==1){		 //在发音函数中要控制多余步骤的时间，不能每次进入运行的时间不一样，影响音符频率
			    sign=checkKey(m,flag);	   //按键检测函数
				if(sign!=0)
				{
				time=0;
					if((sign%7)==0)							  //显示被按下的按键
		             show_Pic(16*6,47,2,16,key1);
		        else
		             show_Pic(16*(sign%7)-16,47,2,16,key1);
					showStatus(streak);	  //显示连击数
				if(sign==m){ 			   //m为当前正在播放的音符
				     flag=1;
					 streak=streak+1;		//连击+1
					 score=score+1;			//分数+1
					 if(streak>=5)
					     score=score+1;
					 showStatus(streak);	  //显示连击数
		             showScore(score);	  //显示分数
				        }else
						    streak=0;

				    } 
				} else
				   checkKey(m,flag);	  //补齐对称，确保每次时间一致
			    Sound(m);			 //发声函数
			}
			if(flag==0)
			    streak=0;				 //未按对，连击清0
			if(time==0)				  //有按键按下，复位标志位，复位键盘
			{
			drawPiano();
			time=1;}
			TR0 = 0;
			delay(50);	
		}
		i++;
	}
	musicGameEnd(score);
}

void musicGame2(unsigned char speed)
{
    
	uchar p,m,flag,score,streak,time,sign;   //m为频率常数变量,flag为是否得分,score为得分量,streak为连击次数    
	uchar i=0;
	speed=speed*15;    	  
	TMOD|=0x11;    
	ET0=1; 		 //为了不影响别的使能位
	drawPiano();
	score=0;
	streak=0;
	flag=0;
	time=1;
	showScore(score);
	showStatus(streak);
	while(menuflag==9)
	{
	    if((p%7)==0)
		    show_Pic(16*6,27,2,21,BNOTE0);
		else
		    show_Pic(16*(p%7)-16,27,2,21,BNOTE0);
////		if(flag!=0)
////		{
////		    score=score+1;
////			streak=streak+1;
////		}else
//		    streak=0;		 //判断连击与分数

	    flag=0;
		showStatus(streak);	  //显示连击数
//		showScore(score);	  //显示分数
		//左上角显示接下来要出现的音符
		if(Music_Tab1[i+6]!=0)
		{
		showNote(Music_Tab2[i+2],3);
		showNote(Music_Tab2[i+4],2);
		showNote(Music_Tab2[i+6],1);
		}else if(Music_Tab2[i+4]!=0)
		{
		showNote(Music_Tab2[i+2],3);
		showNote(Music_Tab2[i+4],2);
        showNote(0,1);	//0代表空白
		}else if(Music_Tab2[i+2]!=0)
		{
		showNote(Music_Tab2[i+2],3);
		showNote(0,2);
        showNote(0,1);
		}else
		{
		showNote(0,3);
		showNote(0,2);
        showNote(0,1);
		}


		TH0=0xd8;TL0=0xef;
		p = Music_Tab2[i];
		if(p==0)break;
		else
		{
			m = p; 
			i++;
			n = Music_Tab2[i]*speed;		 //改变这个可以调整每个音的时间长短
			TR0 = 1;
			rushNote(p);
			while(n!=0)
			{
				
				if(time==1){
			    sign=checkKey(m,flag);
				if(sign!=0)
				{
				time=0;
					if((sign%7)==0)
		             show_Pic(16*6,47,2,16,key1);
		        else
		             show_Pic(16*(sign%7)-16,47,2,16,key1);
					showStatus(streak);	  //显示连击数
				if(sign==m){ 
				     flag=1;
					 streak=streak+1;
					 score=score+1;
					 if(streak>=5)
					     score=score+1;
					 showStatus(streak);	  //显示连击数
		             showScore(score);	  //显示分数
				        }else
						    streak=0;

				    } 
				} else
				   checkKey(m,flag);
			    Sound(m);
			}
			if(flag==0)
			    streak=0;
			if(time==0)
			{
			drawPiano();
			time=1;}
			TR0 = 0;
			delay(50);	
		}
		i++;
	}
	musicGameEnd(score);
}